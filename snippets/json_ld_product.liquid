{% comment %}
<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Product",
  "name": "{{ product.title | escape }}",
  "url": "{{ shop.url }}{{ product.url }}",
  {%- if product.featured_image -%}
    {%- assign image_size = product.featured_image.width | append: 'x' -%}
    "image": [
      "https:{{ product.featured_image.src | img_url: image_size }}"
    ],
  {%- endif -%}
  "description": "{{ product.description | strip_html | escape }}",
  {%- if current_variant.sku != blank -%}
    "sku": "{{ current_variant.sku }}",
  {%- endif -%}
  "brand": {
    "@type": "Thing",
    "name": "{{ product.vendor | escape }}"
  },
  {%- if product.variants -%}
    "offers": [
      {%- for variant in product.variants -%}
        {
          "@type" : "Offer",
          "availability" : "http://schema.org/{%- if product.available -%}InStock{%- else -%}OutOfStock{%- endif -%}",
          "price" : "{{ variant.price | divided_by: 100.00 }}",
          "priceCurrency" : "{{ shop.currency }}",
          "url" : "{{ shop.url }}{{ variant.url }}"
        }{%- unless forloop.last -%},{%- endunless -%}
      {%- endfor -%}
    ]
  {%- endif -%}
}
</script>

{% endcomment %}

{%- assign DUOYOYSPPE = 'no' -%}{% comment %}This prevents the output of review schema{% endcomment %}

<script type="application/ld+json">
 {
 "@context": "https://schema.org",
 "@id": {{ canonical_url | json }},
 "@type": "Product",
 {%- if product.first_available_variant.sku != blank -%}
 "sku": {{ product.first_available_variant.sku | json}},
 {%- else -%}
 "sku": {{ product.first_available_variant.id | json }},
 {%- endif -%}
 {%- if product.first_available_variant.sku != blank -%}
 "mpn": {{ product.first_available_variant.sku | json }},
 {%- else -%}
 "mpn": {{ product.first_available_variant.id | json }},
 {%- endif -%}
 "brand": {
 "@type": "Brand",
 "name": {{ product.vendor | json }}
 },
 "description": {{ product.description | strip_html | json }},
 "url": {{ canonical_url | json }},
 "name": {{ product.title | json }},
 {%- if product.featured_image -%}
 "image": "https:{{ product.featured_image | product_img_url: 'master' }}",
 {%- endif -%}
 "offers": [
 {%- for VMVJUSSSPT in product.variants -%}
 {
 "@type": "Offer",
 {%- if VMVJUSSSPT.available == true -%}
 {%- assign GCKFZGRKED = "InStock" -%}
 {%- else -%}
 {%- assign GCKFZGRKED = "OutOfStock" -%}
 {%- endif -%}
 "availability": "https://schema.org/{{ GCKFZGRKED }}",
 "priceCurrency": "{{ shop.currency }}",
 "price": "{{ VMVJUSSSPT.price | money_without_currency | remove: "," }}",
 "priceValidUntil": {{ "today" | date: '%s' | plus: 31536000 | date: "%Y-%m-%d" | json }},
 "itemCondition": "https://schema.org/{{ ZGEFYXPNXV }}",
 "url": {{ canonical_url | append: VMVJUSSSPT.url | json }},
 "image": "https:{{ VMVJUSSSPT.image | default: product.featured_image | img_url: 'master' }}",
 "mpn": {{ VMVJUSSSPT.sku | default: VMVJUSSSPT.id | json }},
 {%- if VMVJUSSSPT.sku != blank -%}
 "sku": {{ VMVJUSSSPT.sku | json }},
 {%- else -%}
 "sku": "{{ VMVJUSSSPT.id }}",
 {%- endif -%}
 {%- if VMVJUSSSPT.barcode.size == 12 -%}
 "gtin12": {{ VMVJUSSSPT.barcode | json }},
 {% endif %}
 {%- if VMVJUSSSPT.barcode.size == 13 -%}
 "gtin13": {{ VMVJUSSSPT.barcode | json }},
 {%- endif -%}
 {%- if VMVJUSSSPT.barcode.size == 14 -%}
 "gtin14": {{ VMVJUSSSPT.barcode | json }},
 {%- endif -%}
 "seller": {
 "@type": "Organization",
 "name": {{ shop.name | json }}
 }
 }
 {%- unless forloop.last -%},{% endunless -%}
 {%- endfor -%}]
 {%- unless DUOYOYSPPE == "no" -%}
 {%- case IYHBWLOMKN -%}
 {%- when 'eggviews' -%}
 {%- assign WAWSGRMUBA = product.metafields.eggviews.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.eggviews.reviews_count -%}
 {%- when 'judgeme' -%}
 {%- when 'kudobuzz' -%}
 {%- assign WAWSGRMUBA = product.metafields.kudobuzz.review_rating -%}
 {%- assign NTNFSZOWWG = product.metafields.kudobuzz.reviews_count -%}
 {%- when 'loox' -%}
 {%- assign WAWSGRMUBA = product.metafields.loox.avg_rating -%}
 {%- assign NTNFSZOWWG = product.metafields.loox.num_reviews -%}
 {%- when 'okendo' -%}
 {%- assign WAWSGRMUBA = product.metafields.okendo.RatingAndReviewAverageValue -%}
 {%- assign NTNFSZOWWG = product.metafields.okendo.RatingAndReviewCount -%}
 {%- when 'opinew' -%}
 {%- assign WAWSGRMUBA = product.metafields.opinew.reviews_rich_snippet | split: 'ratingValue" content="' | last | split: '"' |first | plus: 0 -%}
 {%- assign NTNFSZOWWG = product.metafields.opinew.reviews_rich_snippet | split: 'ratingCount" content="' | last | split: '"' |first | plus: 0 -%}
 {%- when 'orankl' -%}
 {%- assign WAWSGRMUBA = product.metafields.orankl.rating -%}
 {%- assign NTNFSZOWWG = product.metafields.orankl.review_count -%}
 {%- when 'reviewsio' -%}
 {%- assign WAWSGRMUBA = product.metafields.reviewscouk.rating -%}
 {%- assign NTNFSZOWWG = product.metafields.reviewscouk.total -%}
 {%- when 'rivio' -%}
 {%- assign WAWSGRMUBA = product.metafields.reevio.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.reevio.reviews_count -%}
 {%- when 'ryviu' -%}
 {%- assign WAWSGRMUBA = product.metafields.ryviu.reviews | split: 'ratingValue" content="' | last | split: '"' |first | plus: 0 -%}
 {%- assign NTNFSZOWWG = product.metafields.ryviu.reviews | split: 'reviewCount" content="' | last | split: '"' |first | plus: 0 -%}
 {%- when 'shopifyreviews' -%}
 {%- assign WAWSGRMUBA = product.metafields.spr.reviews | split: 'ratingValue": "' | last | split: '",' | first -%}
 {%- assign NTNFSZOWWG = product.metafields.spr.reviews | split: 'reviewCount": "' | last | split: '",' | first -%}
 {%- when 'socialshopwave' -%}
 {%- assign WAWSGRMUBA = product.metafields.ssw.avg_rate -%}
 {%- assign NTNFSZOWWG = product.metafields.ssw.count_rate -%}
 {%- when 'stampedio' -%}
 {%- assign WAWSGRMUBA = product.metafields.stamped.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.stamped.reviews_count -%}
 {%- when 'superreviews' -%}
 {%- assign WAWSGRMUBA = product.metafields.reviewapp.reviews | split: '"average" itemprop="ratingValue">' | last | split: '</span>' |first | plus: 0 -%}
 {%- assign NTNFSZOWWG = product.metafields.reviewapp.reviews | split: '"votes" itemprop="ratingCount">' | last | split: "</span>" | first | plus: 0 -%}
 {%- when 'trust' -%}
 {%- assign WAWSGRMUBA = product.metafields.vnreviews.ratingValue -%}
 {%- assign NTNFSZOWWG = product.metafields.vnreviews.reviewCount -%}
 {%- when 'yotpo' -%}
 {%- assign WAWSGRMUBA = product.metafields.yotpo.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.yotpo.reviews_count -%}
 {%- when 'yotpo_free' -%}
 {%- else -%}
 {%- if product.metafields.yotpo.reviews_count and product.metafields.yotpo.reviews_count != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.yotpo.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.yotpo.reviews_count -%}
 {%- endif -%}
 {%- if product.metafields.kudobuzz.review_rating and product.metafields.kudobuzz.reviews_count != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.kudobuzz.review_rating -%}
 {%- assign NTNFSZOWWG = product.metafields.kudobuzz.reviews_count -%}
 {%- endif -%}
 {%- if product.metafields.loox.num_reviews and product.metafields.loox.num_reviews != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.loox.avg_rating -%}
 {%- assign NTNFSZOWWG = product.metafields.loox.num_reviews -%}
 {%- endif -%}
 {%- if product.metafields.okendo.RatingAndReviewAverageValue and product.metafields.okendo.RatingAndReviewAverageValue != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.okendo.RatingAndReviewAverageValue -%}
 {%- assign NTNFSZOWWG = product.metafields.okendo.RatingAndReviewCount -%}
 {%- endif -%}
 {%- if product.metafields.orankl.RatingAndReviewAverageValue and product.metafields.orankl.RatingAndReviewAverageValue != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.orankl.rating -%}
 {%- assign NTNFSZOWWG = product.metafields.orankl.review_count -%}
 {%- endif -%}
 {%- if product.metafields.reviewscouk.rating and product.metafields.reviewscouk.rating != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.reviewscouk.rating -%}
 {%- assign NTNFSZOWWG = product.metafields.reviewscouk.total -%}
 {%- endif -%}
 {%- if product.metafields.reevio.reviews_average and product.metafields.reevio.reviews_count != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.reevio.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.reevio.reviews_count -%}
 {%- endif -%}
 {%- if product.metafields.ssw.count_rate and product.metafields.ssw.count_rate != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.ssw.avg_rate -%}
 {%- assign NTNFSZOWWG = product.metafields.ssw.count_rate -%}
 {%- endif -%}
 {%- if product.metafields.stamped.reviews_average and product.metafields.stamped.reviews_count != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.stamped.reviews_average -%}
 {%- assign NTNFSZOWWG = product.metafields.stamped.reviews_count -%}
 {%- endif -%}
 {%- if product.metafields.vnreviews.ratingValue and product.metafields.vnreviews.reviewCount != "0" -%}
 {%- assign WAWSGRMUBA = product.metafields.vnreviews.ratingValue -%}
 {%- assign NTNFSZOWWG = product.metafields.vnreviews.reviewCount -%}
 {%- endif -%}
 {%- endcase -%}
     {%- if WAWSGRMUBA != nil and NTNFSZOWWG != nil and NTNFSZOWWG != "0" -%}
 ,"aggregateRating": {
 "@type": "AggregateRating",
 "ratingValue": {{ WAWSGRMUBA }},
 "ratingCount": {{ NTNFSZOWWG }}
 }
 {%- endif -%}
 {%- endunless -%}
 }
 </script>